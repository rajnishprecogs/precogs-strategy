<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Media Strategy | Precogs AI</title>
    <meta name="description"
        content="Precogs AI Social Media Strategy - Content calendar, growth playbook, and competitor analytics.">

    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ============================================
           LIGHT THEME - Precogs AI 
           ============================================ */

        :root {
            --bg-light: #fafbfc;
            --bg-white: #ffffff;
            --bg-glass: rgba(255, 255, 255, 0.7);
            --text-dark: #0f172a;
            --text-secondary: #475569;
            --text-muted: #94a3b8;

            --accent-primary: #8b5cf6;
            --accent-secondary: #a855f7;
            --gradient-primary: linear-gradient(135deg, #8b5cf6, #a855f7, #d946ef);
            --accent-glow: 0 0 30px rgba(139, 92, 246, 0.3);
            --accent-glow-strong: 0 0 40px rgba(139, 92, 246, 0.5);

            --border-light: rgba(0, 0, 0, 0.06);
            --border-accent: rgba(139, 92, 246, 0.2);
            --shadow-soft: 0 4px 20px rgba(0, 0, 0, 0.05);
            --shadow-card: 0 8px 30px rgba(0, 0, 0, 0.08);
            --shadow-glow: 0 8px 40px rgba(139, 92, 246, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--bg-light);
            color: var(--text-dark);
            font-family: 'Outfit', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.7;
            font-size: 16px;
        }

        /* Header */
        .site-header {
            position: sticky;
            top: 0;
            z-index: 1000;
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-light);
            padding: 16px 24px;
        }

        .header-inner {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-link {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
            color: var(--text-dark);
            font-weight: 600;
            font-size: 1.25rem;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            box-shadow: var(--accent-glow);
        }

        .header-nav {
            display: flex;
            align-items: center;
            gap: 28px;
        }

        .header-nav a {
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.95rem;
            font-weight: 500;
            transition: color 0.3s;
        }

        .header-nav a:hover {
            color: var(--accent-primary);
        }

        .cta-btn {
            background: var(--gradient-primary);
            color: white !important;
            padding: 10px 22px;
            border-radius: 10px;
            font-weight: 600;
            box-shadow: var(--accent-glow);
        }

        .cta-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--accent-glow-strong);
        }

        /* Container */
        .page-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        .page-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .page-title {
            font-size: 2.75rem;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 16px;
        }

        .page-meta {
            color: var(--text-muted);
            font-size: 1rem;
        }

        /* Sub-Tabs */
        .sub-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 30px;
            background: var(--bg-white);
            padding: 6px;
            border-radius: 14px;
            border: 1px solid var(--border-light);
            box-shadow: var(--shadow-soft);
            overflow-x: auto;
        }

        .sub-tab-btn {
            flex: 1;
            padding: 12px 18px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-size: 15px;
            font-weight: 500;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            min-width: 140px;
        }

        .sub-tab-btn:hover {
            background: rgba(139, 92, 246, 0.05);
            color: var(--accent-primary);
        }

        .sub-tab-btn.active {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--accent-glow);
        }

        .sub-tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .sub-tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Content Styles */
        h2 {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-dark);
            margin: 40px 0 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-dark);
            margin: 32px 0 16px;
        }

        p {
            margin-bottom: 16px;
            color: var(--text-secondary);
        }

        /* Cards */
        .card {
            background: var(--bg-white);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-soft);
        }

        .highlight-card {
            border-left: 4px solid var(--accent-primary);
            box-shadow: var(--shadow-glow);
        }

        /* Feature Grid */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin: 24px 0;
        }

        .feature-card {
            background: var(--bg-white);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-4px);
            border-color: var(--border-accent);
            box-shadow: var(--shadow-glow);
        }

        .feature-icon {
            font-size: 36px;
            margin-bottom: 12px;
        }

        .feature-card h4 {
            color: var(--text-dark);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .feature-card p {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin: 0;
        }

        /* Tables & Tasks */
        .table-container {
            overflow-x: auto;
            margin: 24px 0;
            border-radius: 16px;
            box-shadow: var(--shadow-soft);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
            background: var(--bg-white);
        }

        .data-table th,
        .data-table td {
            padding: 14px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border-light);
            vertical-align: middle;
        }

        .data-table th {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.08), rgba(168, 85, 247, 0.08));
            color: var(--text-dark);
            font-weight: 600;
            white-space: nowrap;
        }

        .data-table td {
            color: var(--text-secondary);
        }

        /* Task Inputs */
        .task-checkbox {
            width: 20px;
            height: 20px;
            accent-color: var(--accent-primary);
            cursor: pointer;
        }

        .assignee-select {
            padding: 6px 12px;
            border-radius: 8px;
            border: 1px solid var(--border-light);
            background: white;
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
            outline: none;
            transition: all 0.2s;
            width: 100%;
        }

        .assignee-select:focus {
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.1);
        }

        .completed-row {
            background: #f0fdf4;
            opacity: 0.7;
        }

        .completed-row td {
            text-decoration: line-through;
            color: var(--text-muted);
        }

        .add-task-btn {
            background: transparent;
            color: var(--accent-primary);
            border: 1px dashed var(--accent-primary);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-top: 10px;
            width: 100%;
            transition: all 0.2s;
        }

        .add-task-btn:hover {
            background: rgba(139, 92, 246, 0.05);
        }

        /* Analytics Specific */
        .analytics-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 24px;
        }

        .chart-container {
            height: 250px;
            display: flex;
            align-items: flex-end;
            gap: 16px;
            padding: 20px;
            background: var(--bg-white);
            border-radius: 16px;
            border: 1px solid var(--border-light);
            margin-bottom: 24px;
        }

        .chart-bar-group {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            height: 100%;
            justify-content: flex-end;
        }

        .chart-bar {
            width: 100%;
            background: var(--gradient-primary);
            border-radius: 6px 6px 0 0;
            transition: height 1s ease;
            position: relative;
            min-height: 4px;
            opacity: 0.8;
        }

        .chart-bar:hover {
            opacity: 1;
        }

        .chart-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            text-align: center;
            font-weight: 600;
        }

        .chart-value {
            font-size: 0.8rem;
            color: var(--text-dark);
            font-weight: 700;
            margin-bottom: 4px;
        }

        .competitor-input {
            width: 80px;
            padding: 4px 8px;
            border: 1px solid var(--border-light);
            border-radius: 6px;
        }

        /* Footer */
        .site-footer {
            text-align: center;
            margin-top: 80px;
            padding: 48px 24px;
            border-top: 1px solid var(--border-light);
            color: var(--text-muted);
            background: var(--bg-white);
        }

        .site-footer a {
            color: var(--text-secondary);
            text-decoration: none;
        }

        .tag-growth {
            background: #e0f2fe;
            color: #0284c7;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .tag-post {
            background: #f3e8ff;
            color: #9333ea;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .tag-video {
            background: #fee2e2;
            color: #dc2626;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        @media (max-width: 900px) {
            .analytics-grid {
                grid-template-columns: 1fr;
            }

            .sub-tabs {
                justify-content: flex-start;
            }
        }
    </style>
</head>

<body>

    <!-- Header -->
    <header class="site-header">
        <div class="header-inner">
            <a href="https://precogs.ai" class="logo-link">
                <div class="logo-icon">üîÆ</div>
                <span>Precogs AI</span>
            </a>
            <nav class="header-nav">
                <a href="../index.html">Docs</a>
                <a href="../Blog/sql-injection.html">Blog</a>
                <a href="https://precogs.ai" target="_blank" class="cta-btn">Try Free Scan ‚Üí</a>
            </nav>
        </div>
    </header>

    <div class="page-container">

        <header class="page-header">
            <h1 class="page-title">üì± Social Media Headquarters</h1>
            <p class="page-meta">Growth Engine ‚Ä¢ Content Calendar ‚Ä¢ Competitor Analytics</p>
        </header>

        <!-- Sub-Tabs -->
        <div class="sub-tabs">
            <button class="sub-tab-btn active" onclick="switchSubTab(event, 'sm-analytics')">üìà Analytics
                Dashboard</button>
            <button class="sub-tab-btn" onclick="switchSubTab(event, 'sm-calendar')">üìÖ Content Calendar</button>
            <button class="sub-tab-btn" onclick="switchSubTab(event, 'sm-growth')">üöÄ Growth Playbook</button>
            <button class="sub-tab-btn" onclick="switchSubTab(event, 'sm-blog')">‚úçÔ∏è Blog Engine</button>
        </div>

        <!-- Tab: Analytics Dashboard (NEW) -->
        <div id="sm-analytics" class="sub-tab-content active">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
                <h2>üìà Competitor Intelligence</h2>
                <button class="cta-btn" onclick="saveAllAnalytics()">üíæ Save Changes</button>
            </div>

            <div class="analytics-grid">
                <!-- Main Section: Charts & Data -->
                <div>
                    <div class="card">
                        <h3>üèÜ Share of Voice (Followers)</h3>
                        <div class="chart-container" id="followersChart">
                            <!-- Bars injected by JS -->
                        </div>
                    </div>

                    <div class="card">
                        <h3>üìä Tracking Engine</h3>
                        <p class="page-meta">Update weekly to track growth velocity.</p>
                        <div class="table-container">
                            <table class="data-table" id="analyticsTable">
                                <thead>
                                    <tr>
                                        <th>Competitor</th>
                                        <th>X Followers</th>
                                        <th>LinkedIn</th>
                                        <th>Growth Trend</th>
                                        <th>Winning Strategy</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Rows injected by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Sidebar: Insights -->
                <div>
                    <div class="card highlight-card">
                        <h3>ü§ñ Precogs AI Growth</h3>
                        <h1 style="font-size: 3rem; color: var(--accent-primary); margin: 10px 0;">361</h1>
                        <p><strong>+42</strong> this week</p>
                        <p style="color: #10b981; font-weight: 600;">Upper Quartile Velocity üöÄ</p>
                    </div>

                    <div class="card">
                        <h3>üß† Engagement Intelligence</h3>
                        <h4>Snyk Strategy</h4>
                        <p>Heavy on "DevRel Memes" and conference photos. Humanizes the brand.</p>
                        <hr style="border:0; border-top:1px solid #eee; margin: 10px 0;">
                        <h4>CodeRabbit Strategy</h4>
                        <p>AI Demos that look "Magic". Very visual.</p>
                        <hr style="border:0; border-top:1px solid #eee; margin: 10px 0;">
                        <h4>Aikido Strategy</h4>
                        <p>Founder-led content. "Real talk" about security fatigue.</p>
                    </div>
                </div>
            </div>
        </div>


        <!-- Tab: Calendar (Enhanced with Dynamic Tasks) -->
        <div id="sm-calendar" class="sub-tab-content">
            <h2>üìÖ Week 1: Launch Week</h2>

            <!-- Monday -->
            <div class="card">
                <h3 style="margin-top:0;">üî¥ Monday, December 16</h3>
                <div class="table-container">
                    <table class="data-table" id="table-mon">
                        <thead>
                            <tr>
                                <th width="40">‚úÖ</th>
                                <th width="100">Time</th>
                                <th width="100">Type</th>
                                <th>Task / Content</th>
                                <th width="150">Assignee</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Static Tasks -->
                            <tr id="task-m16-1">
                                <td><input type="checkbox" class="task-checkbox" onchange="toggleTask('task-m16-1')">
                                </td>
                                <td>08:30 AM</td>
                                <td><span class="tag-growth">Growth</span></td>
                                <td><strong>Reply Guy Sprint:</strong> Reply to 10 tweets searching for
                                    <code>"false positive"</code>.</td>
                                <td><select class="assignee-select" id="assign-m16-1"></select></td>
                            </tr>
                            <tr id="task-m16-2">
                                <td><input type="checkbox" class="task-checkbox" onchange="toggleTask('task-m16-2')">
                                </td>
                                <td>09:00 AM</td>
                                <td><span class="tag-post">Post</span></td>
                                <td>üßµ <strong>Intro Thread:</strong> "üîÆ Introducing Precogs AI..."</td>
                                <td><select class="assignee-select" id="assign-m16-2"></select></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-task-btn" onclick="addNewTask('table-mon', 'mon')">+ Add Custom Task</button>
                </div>
            </div>

            <!-- Tuesday -->
            <div class="card">
                <h3 style="margin-top:0;">Tuesday, December 17</h3>
                <div class="table-container">
                    <table class="data-table" id="table-tue">
                        <thead>
                            <tr>
                                <th width="40">‚úÖ</th>
                                <th width="100">Time</th>
                                <th width="100">Type</th>
                                <th>Task / Content</th>
                                <th width="150">Assignee</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="task-t17-1">
                                <td><input type="checkbox" class="task-checkbox" onchange="toggleTask('task-t17-1')">
                                </td>
                                <td>08:30 AM</td>
                                <td><span class="tag-growth">Growth</span></td>
                                <td><strong>Influencer Draft:</strong> Notifications ON for @troyhunt. Reply within 10
                                    mins.</td>
                                <td><select class="assignee-select" id="assign-t17-1"></select></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-task-btn" onclick="addNewTask('table-tue', 'tue')">+ Add Custom Task</button>
                </div>
            </div>

            <!-- Wednesday -->
            <div class="card">
                <h3 style="margin-top:0;">Wednesday, December 18</h3>
                <div class="table-container">
                    <table class="data-table" id="table-wed">
                        <thead>
                            <tr>
                                <th width="40">‚úÖ</th>
                                <th width="100">Time</th>
                                <th width="100">Type</th>
                                <th>Task / Content</th>
                                <th width="150">Assignee</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="task-w18-1">
                                <td><input type="checkbox" class="task-checkbox" onchange="toggleTask('task-w18-1')">
                                </td>
                                <td>08:30 AM</td>
                                <td><span class="tag-growth">Growth</span></td>
                                <td><strong>Competitor Stealth:</strong> Search <code>"CodeRabbit vs Snyk"</code>. Pitch
                                    Precogs.</td>
                                <td><select class="assignee-select" id="assign-w18-1"></select></td>
                            </tr>
                            <tr id="task-w18-3">
                                <td><input type="checkbox" class="task-checkbox" onchange="toggleTask('task-w18-3')">
                                </td>
                                <td>03:00 PM</td>
                                <td><span class="tag-video">Video</span></td>
                                <td><strong>YouTube Upload:</strong> "GitHub to Report in 60s"</td>
                                <td><select class="assignee-select" id="assign-w18-3"></select></td>
                            </tr>
                        </tbody>
                    </table>
                    <button class="add-task-btn" onclick="addNewTask('table-wed', 'wed')">+ Add Custom Task</button>
                </div>
            </div>
        </div>

        <!-- Tab: Growth Playbook -->
        <div id="sm-growth" class="sub-tab-content">
            <h2>üöÄ Growth Engines</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon">ü§ñ</div>
                    <h4>AI Growth Hacking</h4>
                    <p>Using LLMs to scale engagement.</p>
                </div>
                <!-- ... Content from previous step preserved ... -->
            </div>
            <h3>ü§ñ How to Grow with AI (ChatGPT/Claude)</h3>
            <div class="card">
                <h4>Content Repurposing</h4>
                <div class="code-block">
                    <code>Prompt: Analyze this blog. Extract 5 insights. Write 5 viral X threads (hook, insight, payoff).</code>
                </div>
            </div>
        </div>

        <!-- Tab: Blog Engine -->
        <div id="sm-blog" class="sub-tab-content">
            <h2>‚úçÔ∏è Blog Engine</h2>
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th width="30">Status</th>
                            <th>Topic</th>
                            <th>Assignee</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span style="background:#dbeafe; padding:4px 8px; border-radius:4px;">Drafting</span>
                            </td>
                            <td><strong>The End of Pattern Matching</strong></td>
                            <td><select class="assignee-select" id="assign-blog-1"></select></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>

    <!-- Footer -->
    <footer class="site-footer">
        <p>¬© 2024 Precogs AI. All rights reserved.</p>
        <p><a href="../index.html">‚Üê Back to Documentation</a></p>
    </footer>

    <script>
        // --- CONSTANTS ---
        const ASSIGNEES = ["Unassigned", "Rajnish", "Yasi", "Sameer", "Abhishek", "Avinash", "AI Agents", "Team", "TBD"];
        const COMPETITORS = [
            { name: "Precogs AI", followers: 361, strategies: "AI Prediction" },
            { name: "Snyk", followers: 125000, strategies: "DevRel Memes" },
            { name: "CodeRabbit", followers: 15400, strategies: "AI Demos" },
            { name: "Aikido", followers: 8500, strategies: "Real Talk" },
            { name: "Checkmarx", followers: 45000, strategies: "Enterprise" },
            { name: "Veracode", followers: 52000, strategies: "Reports" },
            { name: "Semgrep", followers: 12000, strategies: "AppSec" },
            { name: "SonarCube", followers: 65000, strategies: "Code Quality" }
        ];

        // --- INIT ---
        document.addEventListener('DOMContentLoaded', () => {
            initAssignees();
            initAnalytics();
            loadTasks();
            loadCustomTasks();
        });

        // --- TAB SWITCHING ---
        function switchSubTab(event, tabId) {
            document.querySelectorAll('.sub-tab-btn').forEach(btn => btn.classList.remove('active'));
            event.currentTarget.classList.add('active');
            document.querySelectorAll('.sub-tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');

            // Re-render chart if analytics tab opened to ensure proper width
            if (tabId === 'sm-analytics') renderChart();
        }

        // --- TASK MANAGMENT ---
        function initAssignees() {
            document.querySelectorAll('.assignee-select').forEach(select => {
                // Keep selected value if saved
                const savedVal = localStorage.getItem('assign_' + select.id);
                select.innerHTML = ''; // Clear current
                ASSIGNEES.forEach(name => {
                    const opt = document.createElement('option');
                    opt.value = name;
                    opt.textContent = name;
                    if (name === savedVal) opt.selected = true;
                    select.appendChild(opt);
                });

                select.onchange = function () {
                    localStorage.setItem('assign_' + this.id, this.value);
                }
            });
        }

        function toggleTask(id) {
            const row = document.getElementById(id);
            const checkbox = row.querySelector('.task-checkbox');
            if (checkbox.checked) row.classList.add('completed-row');
            else row.classList.remove('completed-row');

            localStorage.setItem('task_status_' + id, checkbox.checked);
        }

        function loadTasks() {
            document.querySelectorAll('.task-checkbox').forEach(cb => {
                const rowId = cb.closest('tr').id;
                const isChecked = localStorage.getItem('task_status_' + rowId) === 'true';
                cb.checked = isChecked;
                if (isChecked) cb.closest('tr').classList.add('completed-row');
            });
        }

        // --- DYNAMIC TASKS (CUSTOM) ---
        function addNewTask(tableId, dayKey) {
            const table = document.getElementById(tableId).querySelector('tbody');
            const taskId = `custom-${dayKey}-${Date.now()}`;

            const newRow = document.createElement('tr');
            newRow.id = taskId;
            newRow.innerHTML = `
                <td><input type="checkbox" class="task-checkbox" onchange="toggleTask('${taskId}')"></td>
                <td contenteditable="true" onblur="saveCustomTasks()">12:00 PM</td>
                <td contenteditable="true" onblur="saveCustomTasks()">Task</td>
                <td contenteditable="true" onblur="saveCustomTasks()">New Custom Task</td>
                <td><select class="assignee-select custom-assign" id="assign-${taskId}" onchange="saveCustomTasks()"></select></td>
            `;

            table.appendChild(newRow);

            // Init assignees for new row
            const select = newRow.querySelector('select');
            ASSIGNEES.forEach(name => {
                const opt = document.createElement('option');
                opt.value = name;
                opt.textContent = name;
                select.appendChild(opt);
            });

            saveCustomTasks();
        }

        function saveCustomTasks() {
            const customTasks = [];
            document.querySelectorAll('tr[id^="custom-"]').forEach(row => {
                customTasks.push({
                    id: row.id,
                    parentId: row.closest('table').id,
                    html: row.innerHTML,
                    assignee: row.querySelector('select').value
                });
            });
            localStorage.setItem('precogs_custom_tasks', JSON.stringify(customTasks));
        }

        function loadCustomTasks() {
            const tasks = JSON.parse(localStorage.getItem('precogs_custom_tasks') || '[]');
            tasks.forEach(task => {
                const table = document.getElementById(task.parentId);
                if (table) {
                    const newRow = document.createElement('tr');
                    newRow.id = task.id;
                    newRow.innerHTML = task.html;
                    table.querySelector('tbody').appendChild(newRow);
                    // Restore select value
                    const select = newRow.querySelector('select');
                    select.value = task.assignee;
                    select.onchange = saveCustomTasks; // Re-bind listener

                    // Re-bind listeners for editables
                    newRow.querySelectorAll('[contenteditable]').forEach(el => el.onblur = saveCustomTasks);
                }
            });
            // Re-check completion status
            loadTasks();
        }


        // --- ANALYTICS ENGINE ---
        function initAnalytics() {
            const savedData = JSON.parse(localStorage.getItem('precogs_analytics_data'));
            const data = savedData || COMPETITORS;

            const tbody = document.getElementById('analyticsTable').querySelector('tbody');
            tbody.innerHTML = '';

            data.forEach(comp => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${comp.name}</strong></td>
                    <td><input type="number" class="competitor-input" value="${comp.followers}" data-name="${comp.name}"></td>
                    <td>Active</td>
                    <td><span style="color:#10b981">‚Üó Growing</span></td>
                    <td>${comp.strategies}</td>
                `;
                tbody.appendChild(row);
            });

            renderChart(data);
        }

        function saveAllAnalytics() {
            const newData = [];
            const rows = document.getElementById('analyticsTable').querySelectorAll('tbody tr');

            rows.forEach(row => {
                const name = row.querySelector('td:first-child').innerText;
                const followers = parseInt(row.querySelector('input').value);
                const strategy = row.querySelector('td:last-child').innerText;
                newData.push({ name: name, followers: followers, strategies: strategy });
            });

            localStorage.setItem('precogs_analytics_data', JSON.stringify(newData));
            renderChart(newData);
            alert('Analytics Saved!');
        }

        function renderChart(data) {
            if (!data) {
                data = JSON.parse(localStorage.getItem('precogs_analytics_data')) || COMPETITORS;
            }

            // Sort by followers desc
            const sorted = [...data].sort((a, b) => b.followers - a.followers);
            const max = sorted[0].followers;

            const container = document.getElementById('followersChart');
            container.innerHTML = '';

            sorted.forEach(item => {
                const heightPct = Math.max((item.followers / max) * 100, 5); // min 5% height

                const group = document.createElement('div');
                group.className = 'chart-bar-group';
                group.innerHTML = `
                    <div class="chart-value">${kFormatter(item.followers)}</div>
                    <div class="chart-bar" style="height: ${heightPct}%"></div>
                    <div class="chart-label">${item.name}</div>
                 `;
                container.appendChild(group);
            });
        }

        function kFormatter(num) {
            return Math.abs(num) > 999 ? Math.sign(num) * ((Math.abs(num) / 1000).toFixed(1)) + 'k' : Math.sign(num) * Math.abs(num)
        }

    </script>

</body>

</html>